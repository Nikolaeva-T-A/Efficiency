Описание

Скрипт АнализЭффективности.ipynb предназначен для анализа данных из Excel-файлов, связанных с физиологическими показателями. Он позволяет проводить анализ эффективности на основе данных электроэнцефалограммы (EEG), электромиограммы (EMG), температуры (TEMP) и частоты сердечных сокращений (RR).

Скрипт автоматически загружает файлы с расширением .xlsx из указанной директории, фильтрует данные, удаляет артефакты, определяет эффективные и неэффективные участки, а затем записывает результаты в новый файл Excel.

Основные функции

mean_norm: Рассчитывает нормализованные средние значения для двух параметров в зависимости от их изменения.
delta: Вычисляет процентное изменение между начальным и конечным значениями в зависимости от направления изменения.
mean_kvart: Определяет средние значения для первой и последней четверти данных.
Фильтрация и удаление артефактов: Удаляет временные участки с артефактами, основываясь на заданных параметрах.
Определение эффективных и неэффективных участков: Идентифицирует участки данных, в которых имеются заметные изменения в значениях EMG и EEG.

Использование

Поместите файлы .xlsx с данными в указанную папку (измените переменную folder_path на путь к вашей папке).

Убедитесь, что каждый файл содержит два листа:

Info: лист с описательной информацией о пациенте.
Data: лист с измерениями (включая ALPHA1, EMGINT1, TEMP1 и RR1).

Запустите скрипт. Он автоматически обработает файлы и создаст новый файл efficiacy_filtered.xlsx, содержащий результаты анализа.
Установка необходимых библиотек

Для работы скрипта необходимо установить библиотеки:

bash

pip install pandas matplotlib openpyxl xlrd


Примечания

Программа выводит сообщения об ошибках в случае некорректной структуры файлов.
Убедитесь, что данные являются корректными и не содержат пропусков в значениях, что может привести к ошибкам в расчетах.

Пример структуры данных


Лист Info
Пациент:	Пациент
Курс:	Новый курс
Сеанс:	1
Сессия:	   Альфа тренинг порог 130%
	
Усредненные за 1 сек. данные	



Лист Data

ALPHA1			EMGINT1			TEMP1			RR1	
Время, сек	Значение		Время, сек	Значение		Время, сек	Значение		Время, сек	Значение
1	3,60131454467773		1	3,41507077217102		1	84,3976745605469		1	918,0625
2	4,73641014099121		2	3,77932095527649		2	84,3989868164063		2	736,109375




Запустив скрипт, вы получите проанализированные данные в виде таблиц, включая как эффективные, так и неэффективные участки, а также соответствующие выводы по каждому параметру.


